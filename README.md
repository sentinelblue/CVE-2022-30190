# CVE-20220-30190

> On Monday May 30, 2022, Microsoft issued CVE-2022-30190 regarding the Microsoft Support Diagnostic Tool (MSDT) in Windows vulnerability.
>
> A remote code execution vulnerability exists when MSDT is called using the URL protocol from a calling application such as Word. An attacker who successfully exploits this vulnerability can run arbitrary code with the privileges of the calling application. The attacker can then install programs, view, change, or delete data, or create new accounts in the context allowed by the userâ€™s rights.

Visit the [sentinel]("/sentinel/") directory for more information regarding hunting and alerts with Microsoft Sentinel.

## Proof-of-Concept

Below are two POC repositories. We can confirm the POC by John Hammond works. It is what we used to validate the alerts by opening a "notepad" window via a Word document.

<https://github.com/JohnHammond/msdt-follina>

<https://github.com/onecloudemoji/CVE-2022-30190>

## References

<https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-30190>

<https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/>

<https://www.tenable.com/blog/cve-2022-30190-zero-click-zero-day-in-msdt-exploited-in-the-wild#:~:text=CVE-2022-30190%20is%20a%20remote%20code%20execution%20vulnerability%20in,called%20using%20the%20URL%20protocol%20from%20certain%20applications.>

<https://twitter.com/nao_sec/status/1530196847679401984?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1530196847679401984%7Ctwgr%5E%7Ctwcon%5Es1_&ref_url=https%3A%2F%2Fwww.tenable.com%2Fblog%2Fcve-2022-30190-zero-click-zero-day-in-msdt-exploited-in-the-wild>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30190>
