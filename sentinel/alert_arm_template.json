{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
      "workspaceName": {
        "type": "string",
        "metadata": {
          "description": "Workspace name for Log Analytics where Sentinel is setup."
        }
      },
      "analyticsRuleDisplayName": {
        "type": "string",
        "defaultValue": "todo: default name of alert",
        "metadata": {
          "description": "The display name of the Azure Sentinel custom analytics rule."
        }
      },
      "analyticsRuleDescription": {
        "type": "string",
        "defaultValue": "todo short description",
        "metadata": {
          "description": "The description of the Azure Sentinel custom analytics rule."
        }
      },
      "analyticsRuleSeverity": {
        "type": "string",
        "defaultValue": "High",
        "allowedValues": [
          "Informational",
          "Low",
          "Medium",
          "High"
        ],
        "metadata": {
          "description": "The severity of the Azure Sentinel custom analytics rule."
        }
      }
    },
    "variables": {
      "alertRuleName": "[concat(parameters('workspaceName'), '/Microsoft.SecurityInsights/todo (New-Guid).Guid')]"
    },
    "resources": [
      {
        "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
        "name": "[variables('alertRuleName')]",
        "kind": "Scheduled",
        "apiVersion": "2021-09-01-preview",
        "properties": {
          "displayName": "[parameters('analyticsRuleDisplayName')]",
          "description": "[parameters('analyticsRuleDescription')]",
          "severity": "[parameters('analyticsRuleSeverity')]",
          "enabled": true,
          "query": "todo query",
          "queryFrequency": "todo PT24H",
          "queryPeriod": "todo PT24H",
          "triggerOperator": "GreaterThan",
          "triggerThreshold": 0,
          "suppressionDuration": "todo PT24H",
          "suppressionEnabled": false,
          "tactics": [
            "todo"
          ],
          "alertRuleTemplateName": null,
          "incidentConfiguration": {
            "createIncident": true,
            "groupingConfiguration": {
              "enabled": false,
              "reopenClosedIncident": false,
              "lookbackDuration": "todo PT1H",
              "matchingMethod": "AllEntities",
              "groupByEntities": [],
              "groupByAlertDetails": [],
              "groupByCustomDetails": []
            }
          },
          "eventGroupingSettings": {
            "aggregationKind": "SingleAlert"
          },
          "entityMappings": [
            {
              "entityType": "Account",
              "fieldMappings": [
                {
                  "identifier": "FullName",
                  "columnName": "ParentProcess"
                }
              ]
            },
            {
              "entityType": "Host",
              "fieldMappings": [
                {
                  "identifier": "FullName",
                  "columnName": "User"
                }
              ]
            },
            {
              "entityType": "FileHash",
              "fieldMappings": [
                {
                  "identifier": "Algorithm",
                  "columnName": "AlgorithmHash"
                },
                {
                  "identifier": "Value",
                  "columnName": "TargetProcessSHA256"
                }
              ]
            }
          ]
        }
      }
    ]
  }