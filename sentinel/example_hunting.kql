// search for our alert across a longer period of time
imProcess
| where TimeGenerated > ago(365d)
| where ActingProcessName has_any ("winword.exe", "excel.exe", "outlook.exe", "powerpnt.exe")
| where TargetProcessName contains 'msdt.exe'
| project-reorder 
    TimeGenerated,
    DvcHostname,
    TargetProcessName,
    TargetProcessId,
    TargetProcessCommandLine,
    ActingProcessName,
    ActingProcessId,
    ActingProcessCommandLine,
    *

// a more generic correlation search
imProcess
| where TimeGenerated > ago(365d)
| where ActingProcessName contains "Microsoft Office"
| where TargetProcessName contains 'msdt.exe'
| project-reorder 
    TimeGenerated,
    DvcHostname,
    TargetProcessName,
    TargetProcessId,
    TargetProcessCommandLine,
    ActingProcessName,
    ActingProcessId,
    ActingProcessCommandLine,
    *

// generate usage of msdt.exe 
imProcess
| where TimeGenerated > ago(365d)
| where TargetProcessName contains 'msdt.exe'
| summarize count() by ActingProcessName
| sort by count_ asc 

// generate some summarizations regarding msdt.exe usage
imProcess| where TimeGenerated > ago(365d)
| where TargetProcessName contains 'msdt.exe'
| summarize count() by ActingProcessName, TargetProcessCommandLine
| sort by count_ asc 

// perform a more focused search example based on summarization data from above
imProcess
| where TimeGenerated > ago(365d)
| where TargetProcessName contains 'msdt.exe'
| where ActingProcessName == "C:\\Windows\\System32\\mmc.exe"
 or ActingProcessName == "C:\\Program Files\\Internet Explorer\\iexplore.exe"
| project-reorder 
    TimeGenerated,
    DvcHostname,
    TargetProcessName,
    TargetProcessId,
    TargetProcessCommandLine,
    ActingProcessName,
    ActingProcessId,
    ActingProcessCommandLine,
    *